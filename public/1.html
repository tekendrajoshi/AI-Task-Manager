<!DOCTYPE html>
<html>
<head>
    <title>n8n AI Agent Chat</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        #chatBox {
            width: 100%;
            height: 400px;
            border: 1px solid #aaa;
            background: white;
            padding: 10px;
            overflow-y: scroll;
        }
        .msg {
            margin: 10px 0;
            padding: 8px 12px;
            border-radius: 6px;
            width: fit-content;
            max-width: 80%;
        }
        .user { background: #d0ebff; margin-left: auto; }
        .bot  { background: #e9ecef; }
    </style>
</head>
<body>

<h2>Chat with n8n AI Agent</h2>

<div id="chatBox"></div>

<br>
<input id="msgInput" type="text" style="width: 80%; padding: 10px;" placeholder="Type your message...">
<button onclick="sendMessage()" style="padding: 10px;">Send</button>

<script>
const WEBHOOK_URL = "https://n8n-production-be6f.up.railway.app/webhook/17e8f3f1-996f-448c-86df-16a3ee302e96";

function addMessage(text, type) {
    const box = document.getElementById("chatBox");
    const div = document.createElement("div");
    div.className = "msg " + type;
    div.innerText = text;
    box.appendChild(div);
    box.scrollTop = box.scrollHeight;
}

async function sendMessage() {
    const input = document.getElementById("msgInput");
    const message = input.value.trim();

    if (!message) return;

    addMessage(message, "user");
    input.value = "";

    try {
        const response = await fetch(WEBHOOK_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message })
        });

        let json;

        // ðŸ‘‡ SAFE JSON PARSE (Fixes "Unexpected end of JSON input")
        try {
            json = await response.json();
        } catch {
            json = null;
        }

        // If n8n sent empty text instead of JSON
        if (!json) {
            const text = await response.text();
            addMessage(text || "No reply received", "bot");
            return;
        }

        const aiReply =
            json?.[0]?.output ||
            json?.output ||
            "No reply received";

        addMessage(aiReply, "bot");

    } catch (err) {
        addMessage("Error: " + err.message, "bot");
    }
}
</script>

</body>
</html>


<!-- ok my n8n autiomation is now working and i am able to store tasks now is to make a complete webapp that has one webpage as the dashboard another as the chatting with thhe ai agent section (similar to chatgpts one) and another page where the tasks stored in the sql database(railways i.e. is remotely stored hopw we can extract datas from that too) are fetched and then presented in the webpage with three sections one for completed works another for pending and another for not started ones i.e. classified based on the status or we can aso give user to view the tasks onto did=ff sections classified based priority too. there should be notification system to i.e. the app should notify the user about its pending works time and again and notify about the deadlines. 
 -->